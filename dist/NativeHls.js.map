{"version":3,"sources":["webpack:///webpack/bootstrap e12ceb65a11838732389","webpack:///./index.js","webpack:///./src/js/NativeHls.js","webpack:///./src/js/models/Id3Tag.js","webpack:///./src/js/utils/Http.js","webpack:///./src/js/utils/M3u8Parser.js","webpack:///./package.json"],"names":["POLL_INTERVAL","NativeHls","config","meister","next","manifestParsed","audioMode","metadata","previousMetadata","previousLevel","lowestLevel","dvrThreshold","mediaDuration","endTime","beginTime","mediaSequence","lastMediaSequence","childManifest","qualityStreams","masterPlaylist","baseEndTime","manifestTimeoutId","pollResolutionId","currentResolution","width","height","name","events","item","Promise","resolve","type","supported","errorCode","Meister","ErrorCodes","WRONG_TYPE","browser","isSafari","isiOS","safariDesktopDisabled","isFacebook","NOT_SUPPORTED","drm","drmConfig","one","supportedDRMSystems","Object","keys","forEach","key","NO_DRM","trigger","then","newItem","player","getPlayerByType","audioOnly","mediaType","catch","err","console","error","mediaElement","src","on","onRequestBitrate","bind","onRequestGoLive","textTracks","addEventListener","onAddTextTrack","setInterval","pollResolution","loadManifest","manifest","duration","segments","length","hasDVR","isLive","dvrEnabled","modifiedDuration","startFromBeginning","onRequestSeek","relativePosition","offset","isNaN","currentTime","setTimeout","getNewManifest","playOffset","broadcastTitle","e","targetTime","Number","isFinite","timeOffset","forcedStart","blockSeekForward","event","track","mode","cueChangeEvent","target","activeCues","Array","from","filter","cue","id3Tags","map","value","data","startTime","time","start","end","currentMetadata","currentlyPlaying","title","previousCurrentTime","wasPlaying","playing","playerPlugin","bitrateIndex","utils","resolveUrl","url","play","pause","warn","details","fatal","videoHeight","videoWidth","newBitrate","find","stream","resolution","newBitrateIndex","indexOf","parseInt","bandwith","amountOfNewSegments","i","get","res","m3u8","responseText","parse","streams","filterAudioOnly","onQualitysAvailable","bitrates","push","bitrate","index","currentIndex","clearTimeout","clearInterval","remove","NaN","currentItem","version","MediaPlugin","registerPlugin","pluginName","Id3Tag","_totalMillisecondsDelta","_noop","_activeXHRs","_totalBytesDelta","_maximumHistorySize","_totalBytesDeltaHistory","_totalMillisecondsDeltaHistory","_isObjLiteral","_obj","_test","getPrototypeOf","_verifiedOptions","options","_objectToQueryString","obj","parts","hasOwnProperty","encodeURIComponent","join","_updateProgress","loaded","bytesDownloaded","bytesDelta","millisecondsDelta","timeStamp","timestamp","Http","totalBytesDownloaded","totalSizeInBytes","total","downloadProgress","resetStatistics","callback","instID","constructor","Math","random","Date","getTime","method","timeout","xhr","status","bandwidth","timeOfRequest","timeOfResponse","roundTripTime","onReady","onProgress","onLoadStart","onError","onSuccess","XMLHttpRequest","onreadystatechange","onprogress","call","onloadstart","onerror","downloadingRequests","onload","activeXHR","id","splice","floor","open","responseType","headers","log","setRequestHeader","inst","send","ex","abort","averagedBandwidth","post","abortAll","milliseconds","bytes","avgBandwidth","shift","prototype","done","progress","module","exports","M3u8Parser","text","lines","split","result","nextLineIsStream","previousMediaNumber","streamInfo","line","startsWith","matchBandwith","exec","matchResolution","resolutions","resolutionInfo","matchInfo","parseFloat","matchMediaSequence"],"mappings":"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","file":"dist/NativeHls.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e12ceb65a11838732389","import NativeHls from './src/js/NativeHls';\n\nexport default NativeHls;\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","import Http from './utils/Http';\nimport M3u8Parser from './utils/M3u8Parser';\nimport packageJson from '../../package.json';\n\nimport Id3Tag from './models/Id3Tag';\n\nconst POLL_INTERVAL = 1000;\n\nclass NativeHls extends Meister.MediaPlugin {\n    constructor(config, meister, next) {\n        super(config, meister);\n\n        this.manifestParsed = false;\n\n        this.audioMode = false;\n\n        this.metadata = [];\n        this.previousMetadata = null;\n\n        // Middleware promise chain.\n        this.next = next;\n\n        // -1 for automatic quality selection\n        this.previousLevel = -1;\n        this.lowestLevel = 0;\n\n        this.dvrThreshold = this.config.dvrThreshold;\n\n        if (typeof this.dvrThreshold === 'undefined') {\n            this.dvrThreshold = 300;\n        }\n\n\n        // new\n        this.mediaDuration = 0;\n        this.endTime = 0;\n        this.beginTime = 0;\n        this.mediaSequence = 0;\n        this.lastMediaSequence = 0;\n        this.childManifest = null;\n        this.qualityStreams = [];\n        this.masterPlaylist = null;\n\n        this.baseEndTime = 0;\n\n        this.manifestTimeoutId = null;\n\n        // Keep track of the current playback quality.\n        this.pollResolutionId = null;\n        this.currentResolution = {\n            width: 0,\n            height: 0,\n        };\n\n        this.name = 'nativeHLS';\n        this.events = [];\n    }\n\n    static get pluginName() {\n        return 'NativeHls';\n    }\n\n    static get pluginVersion() {\n        return packageJson.version;\n    }\n\n    isItemSupported(item) {\n        return new Promise((resolve) => {\n            if (item.type !== 'm3u8' && item.type !== 'm3u') {\n                return resolve({\n                    supported: false,\n                    errorCode: Meister.ErrorCodes.WRONG_TYPE,\n                });\n            }\n\n            // Non Safari browsers are not supported.\n            if ((!this.meister.browser.isSafari)\n                // When safariDesktopDisabled is true and it's not iOS disable it.\n                || (!this.meister.browser.isiOS && this.config.safariDesktopDisabled)\n            ) {\n                // Make sure we are not in Facebook mode. Where the User agent is modified.\n                // This means we are Safari on iOS but no indication of it in the user agent.\n                // Allow these browsers to pass.\n                if (!this.meister.browser.isFacebook && !this.meister.browser.isiOS) {\n                    return resolve({\n                        supported: false,\n                        errorCode: Meister.ErrorCodes.NOT_SUPPORTED,\n                    });\n                }\n            }\n\n            if (item.drm || item.drmConfig) {\n                this.meister.one('drmKeySystemSupport', (supportedDRMSystems) => {\n                    let supported = false;\n                    Object.keys(supportedDRMSystems).forEach((key) => {\n                        if ((key === 'com.apple.fps' && supportedDRMSystems[key]) ||\n                            (key === 'com.apple.fps.1_0' && supportedDRMSystems[key]) ||\n                            (key === 'com.apple.fps.2_0' && supportedDRMSystems[key])) {\n                            supported = true;\n                        }\n                    });\n                    return resolve({\n                        supported,\n                        errorCode: supported ? null : Meister.ErrorCodes.NO_DRM,\n                    });\n                });\n\n                this.meister.trigger('requestDrmKeySystemSupport', {});\n            } else {\n                return resolve({\n                    supported: true,\n                });\n            }\n        });\n    }\n\n    resetPrivates() {\n        this.metadata = [];\n        this.previousMetadata = null;\n\n        this.manifestParsed = false;\n\n        this.previousLevel = -1;\n        this.lowestLevel = 0;\n        this.mediaDuration = 0;\n        this.item = null;\n    }\n\n    process(item) {\n        return this.next(item).then((newItem) => {\n            this.player = this.meister.getPlayerByType('html5', newItem);\n            if (this.meister.config.audioOnly || newItem.mediaType === 'audio') {\n                this.audioMode = true;\n            } else {\n                this.audioMode = false;\n            }\n\n            return newItem;\n        }).catch((err) => {\n            console.error(`Something went wrong while processing middlewares. ${err}`);\n        });\n    }\n\n    load(item) {\n        super.load(item);\n        this.item = item;\n\n        return new Promise((resolve) => {\n            this.mediaElement = this.player.mediaElement;\n            this.mediaElement.src = item.src;\n            this.masterPlaylist = item.src;\n\n            // Listen to control events.\n            this.on('requestBitrate', this.onRequestBitrate.bind(this));\n            this.on('requestGoLive', () => this.onRequestGoLive());\n\n            this.mediaElement.textTracks.addEventListener('addtrack', this.onAddTextTrack.bind(this));\n\n            this.pollResolutionId = setInterval(this.pollResolution.bind(this), POLL_INTERVAL);\n\n            // Trigger this to make it look pretty.\n            // Loading the first playlist.\n            this.loadManifest(item.src).then((manifest) => {\n                this.endTime = manifest.duration;\n                this.baseEndTime = this.endTime;\n                this.mediaDuration = manifest.duration;\n                this.mediaSequence = manifest.mediaSequence;\n\n                this.beginTime = this.endTime - this.mediaDuration;\n\n                // Kinda weird, but let's roll with it for now..\n                const lastMediaSequence = Object.keys(manifest.segments)[(Object.keys(manifest.segments).length - 1)];\n                this.lastMediaSequence = lastMediaSequence;\n\n                let hasDVR = ((manifest.duration > this.dvrThreshold) && manifest.isLive);\n\n                if (this.config.dvrEnabled === false) {\n                    hasDVR = false;\n                }\n\n                this.meister.trigger('itemTimeInfo', {\n                    isLive: manifest.isLive,\n                    hasDVR,\n                    duration: this.mediaDuration,\n                    modifiedDuration: this.mediaDuration,\n                    endTime: this.endTime,\n                });\n\n                // We don't want to request live when we want to start from the beginning.\n                if (!item.startFromBeginning) {\n                    // this.onMasterPlaylistLoaded(manifest);\n                    if (manifest.isLive) this.onRequestGoLive();\n                } else {\n                    if (typeof item.startFromBeginning === 'object') {\n                        this.onRequestSeek({\n                            relativePosition: item.startFromBeginning.offset / this.duration,\n                        });\n                    } else {\n                        if (isNaN(this.meister.duration)) {\n                            this.meister.one('playerCanPlay', () => {\n                                this.meister.currentTime = 0;\n                            });\n                        } else {\n                            this.meister.currentTime = 0;\n                        }\n                    }\n\n                }\n\n                this.manifestTimeoutId = setTimeout(() => {\n                    this.getNewManifest();\n                }, 5000); // Amount of seconds should be dynamic (By using the manifest)\n            });\n\n            resolve();\n        });\n    }\n\n    get duration() {\n        return this.mediaDuration;\n    }\n\n    get currentTime() {\n        if (!this.player) { return NaN; }\n\n        const playOffset = this.endTime - this.mediaDuration;\n        return this.player.currentTime - playOffset;\n    }\n\n    set currentTime(time) {\n        if (!this.player) { return; }\n\n        const playOffset = this.endTime - this.mediaDuration;\n        this.player.currentTime = time + playOffset;\n    }\n\n    _onPlayerTimeUpdate() {\n        const playOffset = this.endTime - this.mediaDuration;\n\n        this.meister.trigger('playerTimeUpdate', {\n            currentTime: this.player.currentTime - playOffset,\n            duration: this.mediaDuration,\n        });\n\n        this.broadcastTitle();\n    }\n\n    _onPlayerSeek() {\n        const playOffset = this.endTime - this.mediaDuration;\n\n        const currentTime = this.player.currentTime - playOffset;\n        const duration = this.mediaDuration;\n        const relativePosition = currentTime / duration;\n\n        this.meister.trigger('playerSeek', {\n            relativePosition,\n            currentTime,\n            duration,\n        });\n    }\n\n    onRequestSeek(e) {\n        let targetTime;\n\n        if (Number.isFinite(e.relativePosition)) {\n            const playOffset = this.endTime - this.mediaDuration;\n            targetTime = (this.mediaDuration * e.relativePosition) + playOffset;\n        } else if (Number.isFinite(e.timeOffset)) {\n            targetTime = this.player.currentTime + e.timeOffset;\n        } else if (Number.isFinite(e.targetTime)) {\n            const playOffset = this.endTime - this.mediaDuration;\n            targetTime = e.targetTime + playOffset;\n        }\n\n        // Check whether we are allowed to seek forward.\n        if (!e.forcedStart && this.blockSeekForward && targetTime > this.player.currentTime) { return; }\n\n        if (Number.isFinite(targetTime)) {\n            this.player.currentTime = targetTime;\n        }\n    }\n\n    /**\n     * Event handler for addtrack\n     *\n     * @param {TrackEvent} event\n     * @memberof NativeHls\n     */\n    onAddTextTrack(event) {\n        const track = event.track;\n        track.mode = 'hidden';\n\n        track.addEventListener('cuechange', (cueChangeEvent) => {\n            /** @type {TextTrack} */\n            const target = cueChangeEvent.target;\n            const activeCues = Array.from(target.activeCues).filter(cue => cue.type === 'org.id3');\n            const id3Tags = activeCues.map(cue => new Id3Tag(cue.value.key, cue.value.data, cue.startTime, cue.endTime));\n\n            this.meister.trigger('id3tags', id3Tags);\n        });\n    }\n\n    onRequestGoLive() {\n        if (isNaN(this.player.duration)) {\n            this.meister.one('playerLoadedMetadata', () => {\n                this.onRequestGoLive();\n            });\n        } else {\n            this.player.currentTime = this.endTime - 30;\n        }\n    }\n\n    broadcastTitle() {\n        const time = this.player.currentTime;\n        // No need to spam events.\n        if (this.previousMetadata &&\n                (this.previousMetadata.start < time && time < this.previousMetadata.end)\n            ) {\n            return;\n        }\n\n        // Still playing the same item.\n        const currentMetadata = this.currentlyPlaying;\n        if (this.previousMetadata &&\n                (currentMetadata.title === this.previousMetadata.title)\n            ) {\n            return;\n        }\n\n        // Remember the current metadata for the next call.\n        this.previousMetadata = currentMetadata;\n\n        // Broadcast event for the ui.\n        this.meister.trigger('itemMetadata', {\n            title: currentMetadata.title,\n        });\n    }\n\n\n    onRequestBitrate(e) {\n        const previousCurrentTime = this.player.currentTime;\n        const wasPlaying = this.meister.playing;\n\n        // Since we're setting a new source we could need updated drm settings.\n        if (e.drmConfig) {\n            this.meister.trigger('drmConfig', e.drmConfig);\n        }\n\n        this.meister.playerPlugin.mediaElement.src = '';\n        if (e.bitrateIndex === -1) {\n            this.meister.playerPlugin.mediaElement.src = this.masterPlaylist;\n        } else {\n            this.meister.playerPlugin.mediaElement.src = this.meister.utils.resolveUrl(this.masterPlaylist, this.qualityStreams[e.bitrateIndex].url);\n        }\n\n        // Reset playoffset and endtime, since we cleared the source.\n        this.playOffset = 0;\n        this.endTime = this.baseEndTime;\n\n        this.meister.one('playerLoadedMetadata', () => {\n            this.player.currentTime = previousCurrentTime;\n\n            if (wasPlaying) {\n                this.meister.play();\n            } else {\n                this.meister.pause();\n            }\n        });\n    }\n\n    onError(e, data) {\n        console.warn(`Error in ${this.name}, type: ${data.details}, will attempt to recover.`);\n        if (data.fatal) {\n            console.error(`Can not recover from ${data.type}: ${data.details}.`);\n        }\n    }\n\n    // copypaste from native-hls\n    pollResolution() {\n        const height = this.mediaElement.videoHeight;\n        const width = this.mediaElement.videoWidth;\n\n        if (this.currentResolution.width === width && this.currentResolution.height === height) return;\n\n        const newBitrate = this.qualityStreams.find((stream) =>\n            stream.resolution && stream.resolution.width === width && stream.resolution.height === height\n        );\n\n        // This can happen while switching streams, no need to notify the player.\n        if (!newBitrate) return;\n\n        const newBitrateIndex = this.qualityStreams.indexOf(newBitrate);\n\n        this.meister.trigger('playerAutoSwitchBitrate', {\n            newBitrate: parseInt(newBitrate.bandwith, 10),\n            newBitrateIndex,\n        });\n\n        this.currentResolution = newBitrate.resolution;\n    }\n\n    get currentItem() {\n        const metadata = this.currentlyPlaying;\n\n        const currentItem = {\n            src: this.item.src,\n            type: this.item.type,\n            title: metadata.title,\n            bitrate: metadata.bitrate,\n        };\n\n        return currentItem;\n    }\n\n    get currentlyPlaying() {\n        // Prepare return object.\n        const metadata = {\n            bitrate: 0,\n            title: '',\n        };\n\n        // Traverse backwards since it is more likely that the player is near the end\n        let data = null;\n        const time = this.player.currentTime;\n        for (let i = this.metadata.length - 1; i >= 0; i--) {\n            if (this.metadata[i].start < time && time < this.metadata[i].end) {\n                data = this.metadata[i];\n                break;\n            }\n        }\n\n        if (data) {\n            metadata.title = data.title;\n            metadata.start = data.start;\n            metadata.end = data.end;\n            metadata.duration = data.end - data.start;\n        }\n\n        return metadata;\n    }\n\n    // copypaste from native-hls\n    getNewManifest() {\n        this.loadManifest(this.childManifest).then((manifest) => {\n            const lastMediaSequence = Object.keys(manifest.segments)[(Object.keys(manifest.segments).length - 1)];\n            const amountOfNewSegments = lastMediaSequence - this.lastMediaSequence;\n\n            for (let i = 0; i < amountOfNewSegments; i++) {\n                this.endTime += manifest.segments[Object.keys(manifest.segments)[i]];\n            }\n\n            // Just for testing purposes:\n            this.mediaDuration = manifest.duration;\n            this.beginTime = this.endTime - manifest.duration;\n            this.lastMediaSequence = lastMediaSequence;\n\n            let hasDVR = ((manifest.duration > this.dvrThreshold) && manifest.isLive);\n\n            if (this.config.dvrEnabled === false) {\n                hasDVR = false;\n            }\n\n            this.meister.trigger('itemTimeInfo', {\n                isLive: manifest.isLive,\n                hasDVR,\n                duration: this.mediaDuration,\n                modifiedDuration: this.mediaDuration,\n                endTime: this.endTime,\n            });\n\n            this.manifestTimeoutId = setTimeout(() => {\n                this.getNewManifest();\n            }, 5000);\n        }, () => {\n            console.warn('WARNING: Could not load manifest, retrying loading manifest.');\n            this.manifestTimeoutId = setTimeout(() => {\n                this.getNewManifest();\n            }, 5000);\n        });\n    }\n\n    // copypaste from native-hls\n    loadManifest(src) {\n        return new Promise((resolve) => {\n            Http.get(src, (res) => {\n                const m3u8 = new M3u8Parser(res.responseText);\n                const manifest = m3u8.parse();\n\n                if (manifest.streams.length) {\n                    if (this.config.filterAudioOnly) {\n                        this.qualityStreams = manifest.streams.filter((stream) => stream.resolution);\n                    } else {\n                        this.qualityStreams = manifest.streams;\n                    }\n\n                    this.onQualitysAvailable();\n\n                    this.childManifest = this.meister.utils.resolveUrl(src, manifest.streams[0].url);\n                    // This is the master playlist we need to parse the sub playlist.\n                    this.loadManifest(this.meister.utils.resolveUrl(src, manifest.streams[0].url)).then((childManifest) => {\n                        resolve(childManifest);\n                    });\n                } else {\n                    resolve(manifest);\n                }\n            });\n        });\n    }\n\n    // copypaste from native-hls\n    onQualitysAvailable() {\n        const bitrates = [];\n\n        // Bitrate 0 means auto quality.\n        bitrates.push({\n            bitrate: 0,\n            index: -1,\n        });\n\n        for (let i = 0; i < this.qualityStreams.length; i++) {\n            const bitrate = this.qualityStreams[i];\n            bitrates.push({\n                bitrate: parseInt(bitrate.bandwith, 10),\n                index: i,\n            });\n        }\n\n        // Trigger auto bitrate by default.\n        this.meister.trigger('itemBitrates', {\n            bitrates,\n            currentIndex: -1,\n        });\n    }\n\n    unload() {\n        super.unload();\n        if (this.manifestTimeoutId) clearTimeout(this.manifestTimeoutId);\n        if (this.pollResolutionId) clearInterval(this.pollResolutionId);\n\n        this.meister.remove(this.events);\n\n        this.mediaDuration = 0;\n        this.endTime = 0;\n        this.baseEndTime = 0;\n        this.beginTime = 0;\n        this.mediaSequence = 0;\n        this.lastMediaSequence = 0;\n        this.childManifest = null;\n        this.qualityStreams = [];\n        this.masterPlaylist = null;\n        this.manifestTimeoutId = null;\n        this.pollResolutionId = null;\n        this.currentResolution = {\n            width: 0,\n            height: 0,\n        };\n        this.mediaElement = null;\n    }\n\n    destroy() {\n        super.destroy();\n    }\n}\n\nMeister.registerPlugin(NativeHls.pluginName, NativeHls);\nMeister.registerPlugin('nativehls', NativeHls);\n\nexport default NativeHls;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/NativeHls.js","export default class Id3Tag {\n        /**\n     * Creates an instance of Id3Tag.\n     *\n     * @param {string} key\n     * @param {ArrayBuffer} data\n     * @param {number} [startTime=0]\n     * @param {number} [endTime=0]\n     * @memberof Id3Tag\n     */\n    constructor(key, data, startTime = 0, endTime = 0) {\n        this.data = data;\n        this.key = key;\n        this.type = 'org.id3';\n        this.startTime = startTime;\n        this.endTime = endTime;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/models/Id3Tag.js","/**\n * @class httpModule\n * @type {{getPageByURL, handleResponse, parseCookie, queryStringToJsonObject, jsonObjectToQuerystring}}\n */\n\nvar _totalMillisecondsDelta = 0,\n    _noop = function () {},\n    _activeXHRs = [],\n    _totalBytesDelta = 0,\n    _maximumHistorySize = 7,\n    _totalBytesDeltaHistory = [],\n    _totalMillisecondsDeltaHistory = [],\n    _isObjLiteral = function (_obj) {\n        var _test = _obj;\n        return (typeof _obj !== 'object' || _obj === null ?\n            false :\n            (\n                (function () {\n                    while (!false) {\n                        if (Object.getPrototypeOf(_test = Object.getPrototypeOf(_test)) === null) {\n                            break;\n                        }\n                    }\n                    return Object.getPrototypeOf(_obj) === _test;\n                })()\n            )\n        );\n    },\n    _verifiedOptions = function (options) {\n        if (!_isObjLiteral(options)) {\n            console.error('Cannot construct http request, the options parameter is not an object literal.', options);\n            return false;\n        }\n\n        if (!('method' in options)) {\n            console.error('Cannot construct http request, the method was not specified.', options);\n            return false;\n        }\n\n        if (!('url' in options)) {\n            console.error('Cannot construct http request, the url was not specified.', options);\n            return false;\n        }\n\n        return true;\n    },\n    _objectToQueryString = function (obj) {\n        var parts = [];\n        for (var key in obj) {\n            if (obj.hasOwnProperty(key)) {\n                parts.push(encodeURIComponent(key) + '=' + encodeURIComponent(obj[key]));\n            }\n        }\n        return parts.join('&');\n    },\n    _updateProgress = function (event) {\n        // Make sure to reset the bytes downloaded (can happen after an abort).\n        if (event.loaded < this.bytesDownloaded) {\n            this.bytesDownloaded = 0;\n        }\n\n        // Get the number of new bytes downloaded.\n        var bytesDelta = event.loaded - this.bytesDownloaded,\n            millisecondsDelta = event.timeStamp - this.timestamp;\n\n        // Update the total values.\n        _totalMillisecondsDelta += millisecondsDelta;\n        _totalBytesDelta += bytesDelta;\n        Http.totalBytesDownloaded += bytesDelta;\n\n        // Store local values.\n        this.bytesDownloaded = event.loaded;\n        this.totalSizeInBytes = event.total;\n        this.timestamp = event.timeStamp;\n\n        // Update the progress.\n        this.downloadProgress = this.bytesDownloaded / this.totalSizeInBytes;\n\n        Http.resetStatistics();\n    };\n\n/**\n * Makes an HTTP request and serves as an advanced HTTP Api\n *\n * @param  {[type]}   options  [description]\n * @param  {Function} callback [description]\n * @return {[type]}            [description]\n */\nfunction Http(options, callback) {\n\n    if (!(_verifiedOptions(options))) {\n        return;\n    }\n\n    this.instID = this.constructor.name + '.' + (Math.random() * (new Date().getTime()));\n\n    var method = options.method,\n        url = options.url,\n        data = '',\n        timeout = 'timeout' in options ? options.timeout : 3000,\n        xhr;\n\n    this.timestamp = 0;\n    this.method = method;\n    this.url = url;\n\n    this.status = 0;\n    this.bytesDownloaded = 0;\n    this.totalSizeInBytes = 0;\n    this.downloadProgress = 0;\n    this.bandwidth = null;\n    this.timeOfRequest = null;\n    this.timeOfResponse = null;\n    this.roundTripTime = null;\n    this.onReady = null;\n    this.onProgress = null;\n    this.onLoadStart = null;\n    this.onError = null;\n    this.onSuccess = callback;\n\n    xhr = new XMLHttpRequest();\n\n    if ('data' in options) {\n        data = _objectToQueryString(options.data);\n    }\n\n    xhr.onreadystatechange = function (event) {\n        this.status = xhr.status;\n\n        if (this.onReady !== null) {\n            this.onReady();\n        }\n    }.bind(this);\n\n    xhr.onprogress = function (event) {\n        _updateProgress.call(this, event);\n\n        if (this.onProgress !== null) {\n            this.onProgress();\n        }\n    }.bind(this);\n\n    xhr.onloadstart = function (event) {\n        this.timestamp = event.timeStamp;\n\n        if (this.onLoadStart !== null) {\n            this.onLoadStart();\n        }\n    }.bind(this);\n\n    xhr.onerror = function (event) {\n        Http.downloadingRequests -= 1;\n\n        if (this.onError !== null) {\n            (this.onError || _noop)(xhr);\n        } else {\n            this.onSuccess(null);\n        }\n    }.bind(this);\n\n    xhr.onload = function (event) {\n        _updateProgress.call(this, event);\n\n        Http.downloadingRequests -= 1;\n\n        // Remove the active XHR from active XHRs\n        for (var i = 0; i < _activeXHRs.length; i++) {\n            var activeXHR = _activeXHRs[i];\n\n\n            if (activeXHR.id == this.instID) {\n                _activeXHRs.splice(i, 1);\n            }\n        }\n\n        this.timeOfResponse = (new Date()).getTime();\n        this.roundTripTime = this.timeOfResponse - this.timeOfRequest;\n        xhr.bandwidth = Math.floor((this.bytesDownloaded / this.roundTripTime) * 8 * 1000);\n        this.bandwidth = xhr.bandwidth;\n        this.onSuccess(xhr);\n    }.bind(this);\n\n    // GET requests should have the data in the URL instead of the body\n    if (method === 'GET') {\n        url += data;\n    }\n\n    // Open the asynchronous request\n    xhr.open(method, url, true);\n\n    this.timeOfRequest = (new Date()).getTime();\n    Http.downloadingRequests += 1;\n\n    //Set the responseType\n    if ('responseType' in options) {\n        xhr.responseType = options.responseType;\n    }\n\n    // Add headers, must be done after open but before send (see mdn docs)\n    if ('headers' in options) {\n        for (var key in options.headers) {\n            if (options.headers.hasOwnProperty(key)) {\n                console.log('Setting header', key, 'with', options.headers[key]);\n                xhr.setRequestHeader(key, options.headers[key]);\n            }\n        }\n    }\n\n    _activeXHRs.push({\n        id: this.instID,\n        inst: this\n    });\n\n    try {\n        xhr.send(data);\n    } catch (ex) {\n        console.error('HTTP Request aborted due: ', ex);\n        (this.onError || _noop)(xhr);\n    }\n\n\n    // Listen to timeouts.\n    this.timeout = setTimeout(function () {\n        if (this.bytesDownloaded === 0) {\n            this.abort();\n\n            if (this.onError !== null) {\n                this.onError(xhr);\n            } else {\n                this.onSuccess(null);\n            }\n        }\n\n        clearTimeout(this.timeout);\n    }.bind(this), timeout);\n\n    this.xhr = xhr;\n}\n\nHttp.downloadingRequests = 0;\nHttp.totalBytesDownloaded = 0;\nHttp.averagedBandwidth = 0;\n\nHttp.get = function (url, callback) {\n    var options = {\n        url: url,\n        method: 'GET',\n        data: {}\n    };\n\n    return new Http(options, callback);\n};\n\nHttp.post = function (url, data, callback) {\n    var options = {\n        url: url,\n        method: 'POST',\n        data: data\n    };\n\n    return new Http(options, callback);\n};\n\nHttp.abortAll = function () {\n    for (var i = 0; i < _activeXHRs.length; i++) {\n        var activeXHR = _activeXHRs[i];\n        activeXHR.inst.abort();\n    }\n};\n\nHttp.resetStatistics = function () {\n    var milliseconds = 0.0,\n        bytes = 0.0,\n        avgBandwidth = null,\n        i;\n\n    // Push the total milliseconds delta if there is data.\n    if (_totalMillisecondsDelta > 0) {\n        _totalMillisecondsDeltaHistory.push(_totalMillisecondsDelta);\n        _totalMillisecondsDelta = 0;\n\n        if (_totalMillisecondsDeltaHistory.length > _maximumHistorySize) {\n            _totalMillisecondsDeltaHistory.shift();\n        }\n    }\n\n    // Push the total bytes delta if there is data.\n    if (_totalBytesDelta > 0) {\n        _totalBytesDeltaHistory.push(_totalBytesDelta);\n        _totalBytesDelta = 0;\n        if (_totalBytesDeltaHistory.length > _maximumHistorySize) {\n            _totalBytesDeltaHistory.shift();\n        }\n    }\n\n    // Calculate the total of milliseconds.\n    for (i = 0; i < _totalMillisecondsDeltaHistory.length; i++) {\n        milliseconds += _totalMillisecondsDeltaHistory[i];\n    }\n\n    // Calculate the total of bytes.\n    for (i = 0; i < _totalBytesDeltaHistory.length; i++) {\n        bytes += _totalBytesDeltaHistory[i];\n    }\n\n    // Calculate the average bandwidth.\n    if (milliseconds > 0) {\n        avgBandwidth = (bytes * 1000) / milliseconds;\n    }\n\n    Http.averagedBandwidth = Http.averagedBandwidth === 0 ? avgBandwidth : (Http.averagedBandwidth + avgBandwidth) / 2;\n\n    // Reset all values.\n    _totalMillisecondsDelta = 0;\n    _totalBytesDelta = 0;\n    //Http.totalBytesDownloaded = 0;\n};\n\nHttp.prototype.abort = function () {\n    var xhr = this.xhr;\n    xhr.onerror = null;\n\n    // Abort the download.\n    xhr.abort();\n\n    // Update the number of active requests.\n    Http.downloadingRequests -= 1;\n};\n\n/**\n * Sugar syntax for when a request is done\n *\n * @param  {Function} callback [description]\n * @return {Function}          [description]\n */\nHttp.prototype.done = function (callback) {\n    this.onSuccess = callback;\n    return this;\n};\n\n/**\n * Sugar syntax for when a request throws an error\n *\n * @param  {Function} callback [description]\n * @return {[type]}            [description]\n */\nHttp.prototype.error = function (callback) {\n    this.onError = callback;\n    return this;\n};\n\n/**\n * Sugar syntax for when a request has progress\n *\n * @param  {Function} callback [description]\n * @return {[type]}            [description]\n */\nHttp.prototype.progress = function (callback) {\n    this.onProgress = callback;\n    return this;\n};\n\nmodule.exports = Http;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/Http.js","class M3u8Parser {\n    constructor(text) {\n        this.text = text;\n    }\n\n    parse() {\n        const lines = this.text.split('\\n');\n        const result = {\n            streams: [],\n            segments: {},\n            mediaSequence: 0,\n            duration: 0,\n            isLive: true,\n        };\n\n        let nextLineIsStream = false;\n        let previousMediaNumber = result.mediaSequence;\n        let streamInfo = {};\n\n        lines.forEach((line) => {\n            if (nextLineIsStream) {\n                streamInfo.url = line;\n                result.streams.push(streamInfo);\n                streamInfo = {};\n                nextLineIsStream = false;\n            }\n\n            if (line.startsWith('#EXT-X-STREAM-INF')) {\n                nextLineIsStream = true;\n            }\n\n            if (line.startsWith('#EXT-X-ENDLIST')) {\n                result.isLive = false;\n            }\n\n            // #EXT-X-STREAM-INF:PROGRAM-ID=1,RESOLUTION=600x338,BANDWIDTH=712704\n            const matchBandwith = (/^#EXT-X-STREAM-INF:.*BANDWIDTH=(\\d*)?/).exec(line);\n            if (matchBandwith && matchBandwith[1]) {\n                const bandwith = matchBandwith[1];\n                streamInfo.bandwith = bandwith;\n            }\n\n            const matchResolution = (/^#EXT-X-STREAM-INF:.*RESOLUTION=(\\d*x\\d*)?/).exec(line);\n            if (matchResolution && matchResolution[1]) {\n                const resolutions = matchResolution[1].split('x');\n                if (resolutions.length < 2) {\n                    streamInfo.resolution = {\n                        width: 0,\n                        height: 0,\n                    };\n                } else {\n                    const resolutionInfo = {\n                        width: parseInt(resolutions[0], 10),\n                        height: parseInt(resolutions[1], 10),\n                    };\n\n                    streamInfo.resolution = resolutionInfo;\n                }\n            }\n\n            const matchInfo = (/^#EXTINF:?([0-9\\.]*)?,?(.*)?/).exec(line);\n            if (matchInfo && matchInfo[1]) {\n                result.segments[previousMediaNumber] = parseFloat(matchInfo[1]);\n                previousMediaNumber++;\n                result.duration += parseFloat(matchInfo[1]);\n            }\n\n            const matchMediaSequence = (/^#EXT-X-MEDIA-SEQUENCE:?(\\-?[0-9.]*)?/).exec(line);\n            if (matchMediaSequence && matchMediaSequence[1]) {\n                result.mediaSequence = parseInt(matchMediaSequence[1], 10);\n                previousMediaNumber = parseInt(matchMediaSequence[1], 10);\n            }\n        });\n\n        return result;\n    }\n}\n\nexport default M3u8Parser;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/M3u8Parser.js","module.exports = {\n\t\"name\": \"@meisterplayer/plugin-nativehls\",\n\t\"version\": \"5.5.0\",\n\t\"description\": \"Meister plugin for playback of HLS in browsers that support it natively (ex. Safari)\",\n\t\"main\": \"dist/NativeHls.js\",\n\t\"keywords\": [\n\t\t\"meister\",\n\t\t\"video\",\n\t\t\"plugin\",\n\t\t\"hls\"\n\t],\n\t\"repository\": {\n\t\t\"type\": \"git\",\n\t\t\"url\": \"https://github.com/meisterplayer/media-nativehls.git\"\n\t},\n\t\"author\": \"Triple\",\n\t\"license\": \"Apache-2.0\",\n\t\"dependencies\": {},\n\t\"devDependencies\": {\n\t\t\"meister-gulp-webpack-tasks\": \"^1.0.6\",\n\t\t\"meister-js-dev\": \"^3.1.0\",\n\t\t\"babel-preset-es2015\": \"^6.24.0\",\n\t\t\"babel-preset-es2017\": \"^6.22.0\",\n\t\t\"gulp\": \"^3.9.1\"\n\t},\n\t\"peerDependencies\": {\n\t\t\"@meisterplayer/meisterplayer\": \">= 5.1.0\"\n\t}\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./package.json\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}